#!/usr/bin/env bash
#!/bin/bash

# Update package list and install Nginx
sudo apt update && sudo apt install -y nginx

# Ensure Nginx is enabled and started
sudo systemctl enable nginx
sudo systemctl start nginx

# Check and fix Nginx configuration
if ! grep -q "listen 80;" /etc/nginx/sites-enabled/default; then
  sudo sed -i '/server {/a \ \ \ \ listen 80;' /etc/nginx/sites-enabled/default
fi

# Reload Nginx to apply changes
sudo nginx -t && sudo systemctl reload nginx

# Open port 80 in the firewall
sudo ufw allow 80/tcp

# Verify Nginx is listening on port 80
if sudo netstat -tuln | grep -q ":80"; then
  echo "Nginx is running and listening on port 80."
else
  echo "Failed to configure Nginx on port 80."
fi
